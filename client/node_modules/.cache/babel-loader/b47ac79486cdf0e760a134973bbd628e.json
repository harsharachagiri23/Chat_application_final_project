{"ast":null,"code":"import _regeneratorRuntime from\"/Users/harshavardhani/Documents/web_dev_tools/student-bos6250-harshaV0211/final/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _toConsumableArray from\"/Users/harshavardhani/Documents/web_dev_tools/student-bos6250-harshaV0211/final/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/Users/harshavardhani/Documents/web_dev_tools/student-bos6250-harshaV0211/final/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/harshavardhani/Documents/web_dev_tools/student-bos6250-harshaV0211/final/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import{fetchActiveUsers}from'./services';import ScrollToBottom from\"react-scroll-to-bottom\";import Onlineicon from'./icons/onlineIcon.png';import Picker from'emoji-picker-react';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";function Chat(_ref){var socket=_ref.socket,username=_ref.username,room=_ref.room,onLogout=_ref.onLogout,activeUsers=_ref.activeUsers;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),currentMessage=_useState2[0],setCurrentMessage=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),messageList=_useState4[0],setMessageList=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),users=_useState6[0],setUsers=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),chosenEmoji=_useState8[0],setChosenEmoji=_useState8[1];var onEmojiClick=function onEmojiClick(event,emojiObject){setChosenEmoji(emojiObject);};var sendMessage=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var messageData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(currentMessage!==\"\")){_context.next=6;break;}messageData={room:room,author:username,message:currentMessage,time:new Date(Date.now()).getHours()+\":\"+new Date(Date.now()).getMinutes()};_context.next=4;return socket.emit(\"send_message\",messageData);case 4:setMessageList(function(list){return[].concat(_toConsumableArray(list),[messageData]);});setCurrentMessage(\"\");case 6:case\"end\":return _context.stop();}}},_callee);}));return function sendMessage(){return _ref2.apply(this,arguments);};}();useEffect(function(){socket.on(\"receive_message\",function(data){setMessageList(function(list){return[].concat(_toConsumableArray(list),[data]);});});},[socket]);// Checks for new user in room and displays new users \nuseEffect(function(){var chatTimer=setTimeout(function(){fetchActiveUsers(room).then(function(userData){setUsers(userData);});},1*1000);return function(){clearTimeout(chatTimer);};},[users[\"users\"]]);// console.log(\"Data passed from parent component : \", users);\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"chat-window\",children:[/*#__PURE__*/_jsx(\"div\",{children:function(){if(Object.keys(users).length>0){return/*#__PURE__*/_jsxs(\"div\",{className:\"activewindow\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"active_h3\",children:[\"Active on \",room,\" Channel \"]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"ul\",{id:\"list\",children:users[\"users\"].map(function(userInfo){// console.log(\"Inside map : \" , userInfo);\nreturn/*#__PURE__*/_jsx(\"li\",{className:\"activeItem\",children:userInfo.name},userInfo);})})})]});}else{// console.log(\"Inside ELSE BLOCK. ACTIVE USERS DATA : \", users);\nreturn/*#__PURE__*/_jsx(\"div\",{});}}()}),/*#__PURE__*/_jsxs(\"div\",{className:\"header_body_footer_logout\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"chat-header\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\" \",/*#__PURE__*/_jsx(\"img\",{alt:\"Online Icon\",src:Onlineicon,width:\"8px\"}),\"Live Chat \"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-body\",children:/*#__PURE__*/_jsx(ScrollToBottom,{className:\"message-container\",children:messageList.map(function(messageContent){return/*#__PURE__*/_jsx(\"div\",{className:\"message\",id:username===messageContent.author?\"you\":\"other\",children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"message-content\",children:/*#__PURE__*/_jsx(\"p\",{children:messageContent.message})}),/*#__PURE__*/_jsxs(\"div\",{className:\"message-meta\",children:[/*#__PURE__*/_jsx(\"p\",{id:\"time\",children:messageContent.time}),/*#__PURE__*/_jsx(\"p\",{id:\"author\",children:messageContent.author})]})]})});})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-footer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:currentMessage,placeholder:\"Type a message...\",onChange:function onChange(event){setCurrentMessage(event.target.value);},onKeyPress:function onKeyPress(event){event.key===\"Enter\"&&sendMessage();}}),/*#__PURE__*/_jsx(\"button\",{onClick:sendMessage,children:\"\\u25BA\"})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"btn-login\",onClick:onLogout,children:\"Logout\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[chosenEmoji?/*#__PURE__*/_jsxs(\"span\",{children:[\"You chose: \",chosenEmoji.emoji]}):/*#__PURE__*/_jsx(\"span\",{children:\"No emoji Chosen\"}),/*#__PURE__*/_jsx(Picker,{onEmojiClick:onEmojiClick})]})]})]});}export default Chat;","map":{"version":3,"names":["React","useEffect","useState","fetchActiveUsers","ScrollToBottom","Onlineicon","Picker","Chat","socket","username","room","onLogout","activeUsers","currentMessage","setCurrentMessage","messageList","setMessageList","users","setUsers","chosenEmoji","setChosenEmoji","onEmojiClick","event","emojiObject","sendMessage","messageData","author","message","time","Date","now","getHours","getMinutes","emit","list","on","data","chatTimer","setTimeout","then","userData","clearTimeout","Object","keys","length","map","userInfo","name","messageContent","target","value","key","emoji"],"sources":["/Users/harshavardhani/Documents/web_dev_tools/student-bos6250-harshaV0211/final/client/src/Chat.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport {  fetchActiveUsers } from './services';\nimport ScrollToBottom from \"react-scroll-to-bottom\";\nimport Onlineicon from './icons/onlineIcon.png';\nimport Picker from 'emoji-picker-react';\n\nfunction Chat({ socket, username, room , onLogout, activeUsers}) {\n  const [currentMessage, setCurrentMessage] = useState(\"\");\n  const [messageList, setMessageList] = useState([]);\n  const [users, setUsers] = useState({});\n  const [chosenEmoji, setChosenEmoji] = useState(null);\n\n  const onEmojiClick = (event, emojiObject) => {\n    setChosenEmoji(emojiObject);\n  };   \n\n  const sendMessage = async () => {\n    if (currentMessage !== \"\") {\n      const messageData = {\n        room: room,\n        author: username,\n        message: currentMessage,\n        time:\n          new Date(Date.now()).getHours() +\n          \":\" +\n          new Date(Date.now()).getMinutes(),\n      };\n\n      await socket.emit(\"send_message\", messageData);\n      setMessageList((list) => [...list, messageData]);\n      setCurrentMessage(\"\");\n    }\n  };\n\n  useEffect(() => {\n    socket.on(\"receive_message\", (data) => {\n      setMessageList((list) => [...list, data]);\n    });\n    \n  }, [socket]);\n\n  // Checks for new user in room and displays new users \n  useEffect(() => {\n    let chatTimer = setTimeout(() => {\n      fetchActiveUsers(room).then(userData => {\n        setUsers(userData);\n      });\n    }, 1 * 1000);\n\n    return () => {\n      clearTimeout(chatTimer);\n    }\n    \n  }, [users[\"users\"]]);\n\n  // console.log(\"Data passed from parent component : \", users);\n\n  return (\n    <div className=\"chat-window\" >\n        <div >\n            {(() => {\n              if (Object.keys(users).length > 0) {\n                return (\n                  <div className=\"activewindow\">\n                     <h3 className=\"active_h3\">Active on {room} Channel </h3>\n                     <div  >\n                     <ul id=\"list\">\n                        {users[\"users\"].map( (userInfo) =>{\n                          // console.log(\"Inside map : \" , userInfo);\n                          return  <li  key = {userInfo} className=\"activeItem\" >\n                           \n                            {userInfo.name}\n                            \n                          </li>\n                        } )}\n                     </ul>\n                     </div>\n                  </div>\n                )\n              } \n              else {\n                // console.log(\"Inside ELSE BLOCK. ACTIVE USERS DATA : \", users);\n                return (\n                  <div></div>\n                )\n              }\n            })()}\n      </div>\n      <div className=\"header_body_footer_logout\">\n      <div className=\"chat-header\">\n      \n        <p> <img alt=\"Online Icon\" src={Onlineicon} width = \"8px\"/>\n        Live Chat </p>\n       \n      </div>\n      <div className=\"chat-body\">\n        <ScrollToBottom className=\"message-container\">\n          {messageList.map((messageContent) => {\n            return (\n              <div\n                className=\"message\"\n                id={username === messageContent.author ? \"you\" : \"other\"}\n              >\n                <div>\n                  <div className=\"message-content\">\n                    <p>{messageContent.message}</p>\n                  </div>\n                  <div className=\"message-meta\">\n                    <p id=\"time\">{messageContent.time}</p>\n                    <p id=\"author\">{messageContent.author}</p>\n                  </div>\n                </div>\n              </div>\n            );\n          })}\n        </ScrollToBottom>\n      </div>\n      <div className=\"chat-footer\">\n        <input\n          type=\"text\"\n          value={currentMessage}\n          placeholder=\"Type a message...\"\n          onChange={(event) => {\n            setCurrentMessage(event.target.value);\n          }}\n          onKeyPress={(event) => {\n            event.key === \"Enter\" && sendMessage();\n          }}\n        />\n        <button onClick={sendMessage}>&#9658;</button>\n      </div>\n      <div >\n      <button className=\"btn-login\" onClick={onLogout}>Logout</button>\n      </div>\n      <div>\n      {chosenEmoji ? (\n        <span>You chose: {chosenEmoji.emoji}</span>\n      ) : (\n        <span>No emoji Chosen</span>\n      )}\n      <Picker onEmojiClick={onEmojiClick} />\n    </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Chat;"],"mappings":"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"},"metadata":{},"sourceType":"module"}